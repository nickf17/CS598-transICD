2022-04-14 14:27:14,073 Namespace(batch_size=4, data_setting='50', dropout_rate=0.1, embed_size=128, freeze_embed=True, label_attn_expansion=2, learning_rate=[0.001], log='INFO', max_len=2500, model='TransICD', num_attn_heads=8, num_epoch=[30, 35, 40], num_trans_layers=2, random_seed=271, trans_forward_expansion=4)

2022-04-14 14:27:14,502 train set length stats:
count    8066.000000
mean      921.500248
std       483.252560
min        54.000000
25%       578.000000
50%       840.000000
75%      1158.750000
max      5303.000000
Name: LENGTH, dtype: float64
2022-04-14 14:27:14,510 In train set, average code counts per discharge summary: 5.691296801388544
2022-04-14 14:27:14,521 Final number of labels/codes: 50
2022-04-14 14:27:14,535 train set true item count: 8064


2022-04-14 14:27:14,615 dev set length stats:
count    1573.000000
mean     1114.560712
std       471.017010
min       148.000000
25%       796.000000
50%      1040.000000
75%      1326.000000
max      3924.000000
Name: LENGTH, dtype: float64
2022-04-14 14:27:14,622 In dev set, average code counts per discharge summary: 5.881118881118881
2022-04-14 14:27:14,627 Final number of labels/codes: 50
2022-04-14 14:27:14,634 dev set true item count: 1572


2022-04-14 14:27:14,734 test set length stats:
count    1729.000000
mean     1132.429150
std       468.074764
min       127.000000
25%       810.000000
50%      1055.000000
75%      1358.000000
max      4001.000000
Name: LENGTH, dtype: float64
2022-04-14 14:27:14,737 In test set, average code counts per discharge summary: 6.039329091960671
2022-04-14 14:27:14,741 Final number of labels/codes: 50
2022-04-14 14:27:14,751 test set true item count: 1728


2022-04-14 14:27:14,802 Size of training vocabulary including PAD, UNK: 123918
2022-04-14 14:27:17,730 train dataset has on average 0.0018979848923695332 oov words per discharge summary
2022-04-14 14:27:18,436 dev dataset has on average 0.0043540212232293036 oov words per discharge summary
2022-04-14 14:27:19,193 test dataset has on average 0.004234441238066067 oov words per discharge summary
2022-04-14 14:27:19,201 Taining labels are: ['038.9', '244.9', '250.00', '272.0', '272.4', '276.1', '276.2', '285.1', '285.9', '287.5', '305.1', '311', '33.24', '36.15', '37.22', '38.91', '38.93', '39.61', '39.95', '401.9', '403.90', '410.71', '412', '414.01', '424.0', '427.31', '428.0', '45.13', '486', '496', '507.0', '511.9', '518.81', '530.81', '584.9', '585.9', '599.0', '88.56', '88.72', '93.90', '96.04', '96.6', '96.71', '96.72', '99.04', '99.15', '995.92', 'V15.82', 'V45.81', 'V58.61']

2022-04-14 14:27:27,431 Total token count (including PAD, UNK) of full preprocessed discharge summaries: 123918
2022-04-14 14:27:28,254 Training with: HyperParams(learning_rate=0.001, num_epoch=30)
2022-04-14 14:27:28,255 Training Started...
2022-04-14 16:44:16,682 Training finished.

2022-04-14 16:45:29,221 train Accuracy: 0.07800099206349206
2022-04-14 16:45:29,221 train f1 score (micro): 0.6783578215631842
2022-04-14 16:45:29,221 train f1 score (macro): 0.5911495431247897
2022-04-14 16:45:29,221 train auc score (micro): 0.9473161909369898
2022-04-14 16:45:29,221 train auc score (macro): 0.9296017127065928
2022-04-14 16:45:29,221 train precision at ks [1, 5, 8, 10, 15]: [0.8660714285714286, 0.6404017857142859, 0.5174541170634921, 0.45362103174603174, 0.341211970899471]

2022-04-14 16:45:45,107 dev Accuracy: 0.05216284987277354
2022-04-14 16:45:45,107 dev f1 score (micro): 0.6376371308016878
2022-04-14 16:45:45,107 dev f1 score (macro): 0.5431100525246525
2022-04-14 16:45:45,108 dev auc score (micro): 0.9243025891093175
2022-04-14 16:45:45,108 dev auc score (macro): 0.893902891789103
2022-04-14 16:45:45,108 dev precision at ks [1, 5, 8, 10, 15]: [0.833969465648855, 0.6105597964376591, 0.4980120865139949, 0.43931297709923656, 0.33490245971162]

2022-04-14 16:46:08,177 test Accuracy: 0.05092592592592592
2022-04-14 16:46:08,177 test f1 score (micro): 0.6355205078609334
2022-04-14 16:46:08,177 test f1 score (macro): 0.5418352318643341
2022-04-14 16:46:08,177 test auc score (micro): 0.9210594338005611
2022-04-14 16:46:08,177 test auc score (macro): 0.8898011880620948
2022-04-14 16:46:08,177 test precision at ks [1, 5, 8, 10, 15]: [0.8252314814814815, 0.6092592592592593, 0.5031105324074074, 0.4441550925925926, 0.34089506172839507]

2022-04-14 16:46:35,717 Training with: HyperParams(learning_rate=0.001, num_epoch=35)
2022-04-14 16:46:35,718 Training Started...
